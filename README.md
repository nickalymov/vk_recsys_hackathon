# üéØ VK RecSys Challenge ‚Äì AI VK Explicit Feedback Prediction

üß† –£—á–∞—Å—Ç–∏–µ –≤ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–∏ –ø–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—é –ª–∞–π–∫–æ–≤ –∏ –¥–∏–∑–ª–∞–π–∫–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π VK –ö–ª–∏–ø–æ–≤ –æ—Ç AI VK.

üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç**: 13 –º–µ—Å—Ç–æ –∏–∑ 465 –∫–æ–º–∞–Ω–¥  
üí° **ROC-AUC**: `0.6666753935` –Ω–∞ –ø—Ä–∏–≤–∞—Ç–Ω–æ–º –ª–∏–¥–µ—Ä–±–æ—Ä–¥–µ

## üìù –ó–∞–¥–∞—á–∞

–ü–æ—Å—Ç—Ä–æ–∏—Ç—å –º–æ–¥–µ–ª—å, –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—é—â—É—é —è–≤–Ω—ã–π —Ñ–∏–¥–±—ç–∫ (–ª–∞–π–∫ / –¥–∏–∑–ª–∞–π–∫ / –∏–≥–Ω–æ—Ä) –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—é –∫ –≤–∏–¥–µ–æ –≤ VK –ö–ª–∏–ø–∞—Ö.

### üéØ –¶–µ–ª–µ–≤–∞—è –º–µ—Ç—Ä–∏–∫–∞
–ú—É–ª—å—Ç–∏–∫–ª–∞—Å—Å–æ–≤—ã–π ROC-AUC –ø–æ —Ç—Ä–µ–º –º–µ—Ç–∫–∞–º:  
- `like = 1`  
- `dislike = -1`  
- `ignore = 0`

## üìÇ –î–∞–Ω–Ω—ã–µ

**–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç** ‚Äì –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∫–ª–∏–ø–∞–º–∏ –∑–∞ 6 –Ω–µ–¥–µ–ª—å:  
- `user_id`, `item_id`, `timespent`, `like`, `dislike`, `share`, `bookmarks`

**–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**:
- `user_id`, `gender`, `age`

**–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∫–ª–∏–ø–æ–≤**:
- `item_id`, `source_id`, `duration`, `embeddings` (–Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ)

**–¢–µ—Å—Ç–æ–≤—ã–π –¥–∞—Ç–∞—Å–µ—Ç**:
- –ü–∞—Ä—ã `(user_id, item_id)` –∏–∑ 7-–π –Ω–µ–¥–µ–ª–∏, –ø–æ –∫–æ—Ç–æ—Ä—ã–º —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ.

## üß† –õ—É—á—à–µ–µ —Ä–µ—à–µ–Ω–∏–µ

üîó [–ù–æ—É—Ç–±—É–∫](https://github.com/nickalymov/vk_recsys_hackathon/blob/main/8.1_test.ipynb)
üîó [–§–∞–π–ª –¥–ª—è —Å–∞–±–º–∏—Ç–∞](https://github.com/nickalymov/vk_recsys_hackathon/blob/main/8.1_test_e0.csv.7z)

–ú–æ–¥–µ–ª—å DCNv2 —Å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –º–µ—Ç–∞–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± –æ–±—ä–µ–∫—Ç–∞—Ö. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≥–∏–±—Ä–∏–¥–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å Deep & Cross —Å–µ—Ç—è–º–∏, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è item/user features –∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ–º—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∏—Å—Ç–æ—Ä–∏–π –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π (like / dislike / ignore).

---

## üîß –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏

- –í—Ö–æ–¥–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:
  - –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏: `user_id`, `item_id`, `source_id`, `gender`, `age`, `duration_sec`.
  - `item_embed`: —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —ç–º–±–µ–¥–¥–∏–Ω–≥ –ø—Ä–µ–¥–º–µ—Ç–∞ (32).
  - `user_history_embed`: —ç–º–±–µ–¥–¥–∏–Ω–≥ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π (96 = 3 √ó 32), —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –ø–æ 3 –∏—Å—Ç–æ—Ä–∏—è–º:
    - like / dislike / ignore ‚Äî —Å—Ä–µ–¥–Ω–µ–µ –ø–æ –∫–æ—Å–∏–Ω—É—Å–Ω–æ-–±–ª–∏–∑–∫–∏–º –æ–±—ä–µ–∫—Ç–∞–º.

- –ú–æ–¥–µ–ª—å:
  - DCNv2:
    - 3 CrossNet —Å–ª–æ—è.
    - 3 —Å–ª–æ—è MLP.
  - Dropout + LayerNorm.
  - –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ 3 –∫–ª–∞—Å—Å–∞: `0` = dislike, `1` = ignore, `2` = like.

---

## ‚öôÔ∏è –û–±—É—á–µ–Ω–∏–µ

- –õ–æ—Å—Å: `CrossEntropyLoss`.
- –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä: `Adam`, `lr=0.001`.
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–π –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π.
- –í—ã—Ö–æ–¥ –º–æ–¥–µ–ª–∏ ‚Äî –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –ø–æ –∫–ª–∞—Å—Å–∞–º, –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º—ã–µ –≤ score:


## üß™ –ò–Ω—Ñ–µ—Ä–µ–Ω—Å

- –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ `test_pairs.csv` —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π, –∏—Å–ø–æ–ª—å–∑—É—è –¥–∞–Ω–Ω—ã–µ –∏–∑ `train_interactions`.
- –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –¥–µ–ª–∞—é—Ç—Å—è –Ω–∞ —Ç–µ—Ö –∂–µ –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö, —á—Ç–æ –∏ –≤ –æ–±—É—á–µ–Ω–∏–∏.

---

## ‚ùå –ß–µ–≥–æ –Ω–µ —Ö–≤–∞—Ç–∏–ª–æ –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ª—É—á—à–µ?

- üé• **–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π —á–µ—Ä–µ–∑ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏**  
  –í–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ–π –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ (mean-–ø—É–ª–∏–Ω–≥–∞) —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ liked / disliked / ignored –ø—Ä–µ–¥–º–µ—Ç–æ–≤, –º–æ–∂–Ω–æ –±—ã–ª–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –≤—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã ‚Äî —Ç–∞–∫–∏–µ –∫–∞–∫ **Transformer**, GRU –∏–ª–∏ attention-–ø—É–ª—ã ‚Äî –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è **–≤—Ä–µ–º–µ–Ω–Ω–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π.  
  –õ—É—á—à–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –∏–º–µ–Ω–Ω–æ —Ç–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥, –ø–æ–¥–∞–≤–∞—è **–≤—Å—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π** –≤ –º–æ–¥–µ–ª—å, —á—Ç–æ –¥–∞–ª–æ –ø—Ä–∏—Ä–æ—Å—Ç –∫–∞—á–µ—Å—Ç–≤–∞ –∑–∞ —Å—á—ë—Ç —É—á–µ—Ç–∞ –ø–æ—Ä—è–¥–∫–∞ –∏ –Ω–∞—Å—ã—â–µ–Ω–Ω–æ—Å—Ç–∏ –∏—Å—Ç–æ—Ä–∏–∏.

üîó [–õ—É—á—à–∏–µ —Ä–µ—à–µ–Ω–∏—è](https://ods.ai/competitions/aivkchallenge/video)

---

## üìé –°—Å—ã–ª–∫–∞ –Ω–∞ —Å–æ—Ä–µ–≤–Ω–æ–∞–Ω–∏–µ

üîó [–î–∞–Ω–Ω—ã–µ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è –Ω–∞ ODS.ai](https://ods.ai/competitions/aivkchallenge/dataset)
